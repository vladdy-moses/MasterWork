\section{Модели, методы и алгоритмы исследования}

\subsection{Модель информационного взаимодействия}

Для формального определения информационного взаимодействия необходимо определить его элементы.

Прежде всего, в обмене информацией участвует источник данных $S$ и приёмник $D$.
В реальной жизни ими являются программного-аппаратные комплексы информационных систем, однако в случае моделирования и источник, и приёмник можно описать конечным набором некоторых характеристик.
Представим $A_S$ как множество характеристик источника и $A_D$ --- множество характеристик приёмника.
Тогда $A_S \cap A_D = A_{SD}$ --- множество совпадающих характеристик и источника, и приёмника данных.
Для упрощения понимания сути информационного взаимодействия представим источник и приёмник данных через столбцы их характеристик:
$$S = \begin{bmatrix}
s_{1} \\
\vdots \\
s_{n} \\         
\vdots \\
s_{k}
\end{bmatrix},
D = \begin{bmatrix}
d_{1} \\
\vdots \\
d_{n} \\         
\vdots \\
d_{m}
\end{bmatrix},$$
где $n$ -- мощность множества $A_{SD}$ ($n = |A_{SD}|$), $k = |A_S|$, $m = |A_D|$, $s \subset A_S$, $d \subset A_D$.
Примеры характеристик источника и приёмника данных описаны в п.~\ref{sec:modelSDChars}.

Данные передаются по каналу связи $C$.
Им может являться телекоммуникационная сеть Интернет, локальная вычислительная сети предприятия и даже ручная передача данных от источника к приёмнику.
Канал связи также обладает некоторым набором характеристик $A_C$, через которые можно его описать.
Таким образом,
$$
C = \begin{bmatrix}
c_{1} \\
\vdots \\
c_{m}
\end{bmatrix},
$$
где $m = |A_C|$, $c \subset A_C$.
Примеры характеристик канала связи описаны в п.~\ref{sec:modelCChars}.

Данные от источника к приёмнику передаются по определённым правилам, закреплённым в протоколе информационного обмена $P$.
С точки зрения моделирования процесса информационного взаимодействия нас не интересуют отдельные правила передачи данных, закреплённые в протоколе.
Таким образом, протокол $P$ также можно описать при помощи столбца характеристик $A_P$:
$$
P = \begin{bmatrix}
p_{1} \\
\vdots \\
p_{j}
\end{bmatrix},
$$
где $j = |A_P|$, $p \subset A_P$.
Примеры характеристик протокола описаны в п.~\ref{sec:modelPChars}.

Информационный обмен невозможен без описания самих данных, передаваемых в ходе взаимодействия.
Для упрощения назовём такие данные сообщениями.
Пусть множество $A_M$ -- множество характеристик передаваемых сообщений.
Тогда сообщения $M$ можно описать через набор их характеристик:
$$
M = \begin{bmatrix}
m_{1} \\
\vdots \\
m_{q}
\end{bmatrix},
$$
где $q = |A_M|$, $m \subset A_M$.
Примеры характеристик данных (сообщений) описаны в п.~\ref{sec:modelMChars}.

Таким образом, информационное взаимодействие $E$ можно определить следующим образом:
$$
E = <S,D,C,P,M>,
$$
где $E$ -- информационное взаимодействие, $S$ -- источник данных, $D$ -- приёмник данных, $C$ -- канал связи, $P$ -- протокол передачи данных, $M$ -- передаваемое сообщение.
Визуально описанные выше компоненты можно представить в виде рисунка~\ref{img:model-general}.

\myFigure[t]{0.9}{model-general}{Упрощённая схема информационного взаимодействия}

TODO: связи компонентов информационного взаимодействия.

\subsection{Характеристики информационного взаимодействия}

TODO: вступительное описание

\subsubsection{Характеристики источника и приёмника данных}
\label{sec:modelSDChars}

Общими характеристиками источника и приёмника данных могут являться:
\begin{easylist}
& скорость обработки данных;
& максимальное число потоков обработки данных;
& вид и величина деградации скорости обработки данных при увеличении объёма;
& вид и величина деградации скорости обработки данных при увеличении потоков.
\end{easylist}

TODO: ещё

\subsubsection{Характеристики канала связи}
\label{sec:modelCChars}

Характеристиками канала связи могут являться:
\begin{easylist}
& максимальная пропускная способность;
& процент ошибок при передачи данных;
& возможность определения и/или исправления ошибок;
& предельная дальность передачи информации;
& временная задержка при передаче.
\end{easylist}

TODO: подробное описание.

\subsubsection{Характеристики протокола передачи данных}
\label{sec:modelPChars}

Характеристиками протокола передачи данных могут являться:
\begin{easylist}
& коэффициент избыточности сериализованных данных;
& сложность сериализации и десериализации;
& возможность шифрования;
& возможность валидации.
\end{easylist}

TODO: ещё + подробное описание.

\subsubsection{Характеристики данных (сообщений)}
\label{sec:modelMChars}

Характеристиками сообщений могут являться:
\begin{easylist}
& разнородность;
& структурированность;
& связность;
& средний объём сообщения;
& средний объём единицы информации в сообщении.
\end{easylist}

TODO: ещё + описать

\subsection{Основные алгоритмы построения информационного взаимодействия}

\subsubsection{Организация прямого обмена}

Перед реализацией прямого обмена необходимо решить, какие СУБД будут обмениваться информацией, так как не все системы могут взаимодействовать друг с другом.
Например, СУБД Oracle и SQL Server могут выполнять запросы друг к другу, а вот SQL Server и MySQL -- нет.

Затем необходимо выбрать вариант обмена: активный или пассивный и автоматический или автоматизированный.
Об этом более подробно описано в п.~\ref{descrDB}.

Затем необходимо источнику и приёмнику данных договориться о форматах информационного взаимодействия.
Это может быть описание физической модели данных, набора хранимых процедур (с описанием логики их работы но без конкретной релизации) или логической модели данных, если последнее допустимо и необходимо.
В случае реляционных СУБД обычно создаётся отдельный набор таблиц для прямого обмена как у источника, так у приёмника.
Также допускается создание представлений для обмена.

Дополнительно на этапе проектирования необходимо согласовать правила занесения данных в физическую модель данных прямого обмена.
Этот шаг позволяет значительно сократить время на интеграционные испытания и решение конфликтных ситуаций, которые часто возникают при информационном обмене, спроектированном без участия всех заинтересованных сторон.

После согласования разработчики информационных систем приступают к реализации моделей данных и механизмов их заполнения, а также обмена данными между моделями.
На стороне источника данных обычно создаются:
\begin{easylist}
& физическая модель данных;
& механизм заполнения и актуализации модели прямого обмена;
& механизм проверки целостности данных в модели прямого обмена.
\end{easylist}
На стороне приёмника данных обычно создаются те же элементы совместно с:
\begin{easylist}
& механизм контроля связи до источника данных;
& механизм обработки данных из модели прямого обмена;
& механизм проверки корректности данных, занесённый в систему из модели прямого обмена.
\end{easylist}
Дополнительно рекомендуется реализовать механизм кросс-контроля, когда источник данных может проверить собственные данные в системе-приёмнике, однако для этого необходимо либо сильно усложнять прямой обмен, либо использовать другие методы прямого обмена.

После реализации происходит процесс интеграционного тестирования, когда разработчики источника и приёмника совместными усилиями проверяют обмен и все связанные с ним механизмы в своих системах.
Особое внимание на данном этапе стоит уделять корректности данных в модели прямого обмена между источником и приёмником.
К примеру, необходимо удостовериться, что все поля из физической модели источника корректно разложились по соответствующим полям физической модели прямого обмена приёмника данных.
Любые несоответствия должны быть разрешены.
Например, одна система отсутствием данных считает пустую строку, а другая -- специальное значение NULL.
Такой случай необходимо согласовать отдельно и задокументировать.

После проведения интеграционных испытаний и необходимых доработок источника и приёмника данных механизм переходит в промышленную эксплуатацию.

\subsubsection{Обмен реестрами}

Алгоритм обмена реестрами похож на прямой обмен, однако в данном случае нет необходимости заботиться о совместимости хранилищ данных.
Однако, данный механизм содержит ряд особенностей, описанных ниже.

При согласовании форматов информационного обмена как правило последнее слово лежит за более эталонной системой вне зависимости от того, приёмником данных она является или же их источником.
Например, если региональной ИС ЖКХ необходим адресный справочник адресов ФИАС, то формат взаимодействия задаётся источником данных (федеральной адресной системой), а приёмник данных -- региональная система ЖКХ -- должна строить приём данных на основании этих форматов.
И обратный случай: региональная система как приёмник данных определяет форматы реестров для собственных и коммерческих систем, которые хотят размещать свои данные в региональной системе.

Описанный принцип монополии в определении форматов взаимодействия распространяется и на другие механизмы обмена.
Исключением может быть разве что процесс прямого обмена между БД, так как такой метод обычно не используется при построении обмена между системами, состоящими в эталонной иерархии на разных ступенях.
Также не следует считать, что <<подчинённая>> информационная система не может как-то влиять на процесс и форматы информационного обмена.
Это более чем реально при адекватности запросов, аргументированности просьб и соблюдении профессиональной этики.

Перед проектированием и реализацией обмена реестрами необходимо решить: необходимо разрабатывать клиента для раскрытия или получения информации, или же необходимо разработать сервер для получения данных.

При проектировании и разработке клиента необходимо грамотно прочитать документацию, в которой должен быть описан режим доступа к сервису обмена, режим обмена с ним и форматы информационного взаимодействия.
Если клиент разрабатывается для раскрытия информации при помощи реестров, необходимо проверять данные на тестовых стендах сервера.
Не допускается раскрывать не проверенную информацию на промышленных стендах, так как её корректировка и/или удаление может быть трудоёмким, особенно при обмене реестрами.
Вне зависимости от направления потока информации, в конце проведения испытаний требуется процедура проверки выгруженных/полученных данных.
По сравнению, например, с обменом по REST или SOAP, сделать это при обмене реестрами проблематично.
Как правило, это выполняется в ручном режиме на этапе интеграционного тестирования.

Так как реестры обычно содержат большой массив информации, можно делать проверку получения/выгрузки данных контрольными значениями.
Например, точно известно, что в ФИАС имеется шестьдесят тысяч адресных объектов по Ульяновской области.
Соответственно, после загрузки этих объектов в региональную ИС ЖКХ должно быть ровно шестьдесят тысяч адресных объектов по Ульяновской области, у которых установлена связь с ФИАС. Если контрольное значение меньше, то какие-то данные были ошибочно отфильтрованы. Если контрольное значение больше, то какие-то данные были либо не удалены, либо задублированы в региональной ИС ЖКХ.

При проектировании и разработке сервера, принимающего реестры с данными от других информационных систем, необходимо в первую очередь задокументировать режим доступа, форматы взаимодействия, правила обработки записей и механизмы проверки загружаемых данных.

В режиме доступа должно быть указано, как можно получить возможность загружать реестры в информационную систему.
Это может быть либо письменное заявление, либо это право есть у пользователей ИС автоматически, либо любым иным способом.
Идентификация, откуда приходят данные, очень важна для разрешения конфликтов по причине несогласованности данных, которые в любом случае могут возникнуть.
К примеру, управляющая организация в реестре сведений о домах указала, что в доме 9 этажей, а ресурсоснабжающая организация указала для этого же дома 10 этажей.
Обе организации имеют право размещать такие данные, так как у обоих есть договоры управления или поставки ресурсов на конкретный дом.
В этом случае можно применить принцип эталонности данных.
Он заключается в том, что если управляющая организация внесла данные об этажности, то ресурсоснабжающая организация уже не в праве сменить такие данные, однако обратный процесс возможен.
Конечно же, такие правила должны быть закреплены в документации.

В форматах взаимодействия должно быть чётко описан формат данных (DBF, CSV CP1251, CSV UTF8 и т.д.), набор полей с указанием типа данных, описания, флага или условия обязательности, набора возможных значений (для справочных полей).

Правила обработки записей должны включать исчерпывающие описания алгоритмов обработки строк реестров в зависимости от данных в этих строках.
Эти сложности могут быть не совсем очевидны, если реестр загружает простой набор данных без выполнения каких-либо бизнес-процессов.
Однако, если обработчик реестра должен после занесения данных в хранилище данных ещё выполнить набор бизнес-процессов (провести операцию оплаты, обновить процент заполнения паспорта ОЖФ, аннулировать договор управления), то эти правила необходимы.
При любом обмене данными следует учитывать, что выполнение не очевидных действий должно быть задокументировано.

Также при проектировании и разработке сервера обработки реестров необходимо предусмотреть механизм проверки загружаемых данных.
Это может быть реализовано при помощи возвращения клиенту обработанного файла с реестром с дополненными системными столбцами (например, столбцы <<Статус обработки записи>>, <<Идентификатор записи>>, <<Сообщение об ошибке обработки>>) или же возможностью просмотра ошибок обмена в интерфейсе ИС.
В любом случае, необходимо предусмотреть обратную связь сервера с клиентами.

\subsubsection{Построение веб-сервисов SOAP и REST API}

При построении веб-сервисов (не важно, SOAP это или REST API) необходимо в первую очередь определить следующее:
\begin{easylist}
& технология обращения к веб-сервису;
& технология и правила авторизации и аутентификации;
& механизм поддержания версионности веб-сервиса;
& набор операций (методов) веб-сервиса;
& технология и процесс обмена бинарными файлами.
\end{easylist}

Технология обращения к веб-сервису определяется на основании целей и задач разработки веб-сервиса, а также разнородности информационных систем, которые будут с этим веб-сервисов общаться.

Подтверждение пользователя (или информационной системы) является важной частью любого механизма обмена.
Поэтому необходимо изначально определиться с набором алгоритмов прохождения пользователем веб-сервиса авторизации и аутентификации.
Стоит также отметить, что для разных технологий веб-сервисов обычно используются разные механизмы подтверждения клиентов.
К примеру, в SOAP обычно используется подпись канала связи и/или бизнес-данных, а при построении REST API используется OAuth 2, JWT или OpenConnect.

Поддержание версионности веб-сервиса -- основная проблема поддержки веб-сервисов.
Версионность в данном случае понимается как возможность веб-сервса обрабатывать запросы от клиентов, не обновивших форматы взаимодействия до текущих.
Выделяются следующие механизмы поддержания версионности:
\begin{easylist}
& жёсткий. Клиенты со старыми форматами взаимодействия не допускаются к обмену информацией;
& скрытый. Клиент не указывает или указывает один раз при авторизации версию своих форматов данных. Веб-сервис самостоятельно принимает решение об обработке таких данных.
& ручной. Клиент в каждом запросе указывает версию форматов данных. Также адрес веб-сервиса может отличаться для каждой версии форматов данных.
\end{easylist}

Веб-сервис должен включать на каждый вид информации как минимум две операции: получение и размещение.
Для REST API таких операций быть четыре: размещение разделяется на создание и изменение; добавляется удаление.
Если какой-то тип операции отсутствует, это можно привести к неполноценному обмену: потеряется возможность или контролировать выгрузку данных к такому веб-сервису, или заносить данные в систему при помощи API.
Поэтому на этапе проектирования веб-сервиса необходимо грамотно продумать все методы (операции) информационного обмена.

Если информационное взаимодействие предполагает обмен бинарными файлами (что, например, практически невозможно при прямом обмене или обмене реестрами), то необходимо на самом раннем этапе определиться с технологией передачи такого вида информации.
Например, в SOAP передавать бинарные файлы слишком накладно (шифр base64 увеличивает объём передаваемой информации в 1,5 раза), и поэтому в некоторых случаях поднимается REST-сервис для работы с файловым хранилищем, а в SOAP используются только идентификаторы загруженных ранее файлов.

TODO: описание клиента. + выше тоже про это надо бы...

\clearpage
\newpage